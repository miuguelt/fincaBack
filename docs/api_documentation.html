<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>API Documentation - Finca Villa Luz</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background:#f7faf7; color:#1f2937; }
    pre code { white-space: pre-wrap; }
    .container { max-width: 980px; }
    .hero { background: linear-gradient(90deg,#2c5530,#4a7c59); color: #fff; padding: 2rem; border-radius: .5rem; margin-top: 1rem }
    .markdown-body { background: #fff; padding: 1.5rem; border-radius: .5rem; box-shadow: 0 2px 8px rgba(0,0,0,.06) }
  </style>
</head>
<body>
  <div class="container py-4">
    <div class="hero">
      <h1>Finca Villa Luz ‚Äî Documentaci√≥n de la API</h1>
      <p class="mb-0">Versi√≥n generada est√°ticamente desde <code>API_ENDPOINTS_DOCUMENTATION.md</code></p>
    </div>

    <main class="markdown-body mt-4" id="content"></main>

    <footer class="text-muted mt-4 mb-4 small">√öltima actualizaci√≥n: Septiembre 2025</footer>
  </div>

  <!-- Markdown source embedded and rendered client-side -->
  <script id="md-source" type="text/plain">
# üìö Documentaci√≥n Completa de Endpoints - API Gesti√≥n Ganadera

## üéØ Informaci√≥n General

**Base URL**: `https://localhost:8081/api/v1`  
**Autenticaci√≥n**: JWT Bearer Token  
**Formato de Respuesta**: JSON  
**Encoding**: UTF-8  

### üîê Headers Requeridos

```json
{
  "Authorization": "Bearer <jwt_token>",
  "Content-Type": "application/json"
}
```

---

## Formato de respuesta est√°ndar

```json
{
  "success": true,
  "message": "Mensaje descriptivo",
  "data": { },
  "pagination": { },
  "timestamp": "2025-09-02T10:30:00Z"
}
```

---

## Autenticaci√≥n

### POST /api/v1/auth/login

Request body:

```json
{
  "identification": 12345678,
  "password": "password123"
}
```

Response 200 example:

```json
{
  "success": true,
  "message": "Inicio de sesi√≥n exitoso",
  "data": {
    "access_token": "<jwt>",
    "user": {
      "id": 1,
      "fullname": "Juan P√©rez",
      "role": "Administrador",
      "identification": 12345678
    }
  }
}
```

Errors: `401`, `403`, `404` seg√∫n caso.

### POST /api/v1/auth/logout

- Header: `Authorization: Bearer <token>`
- Response: `200` (o `204` seg√∫n implementaci√≥n)

---

## Usuarios

### GET /api/v1/users/

Query params: `page`, `per_page`, `search`, `role`, `status`

Example:

```http
GET /api/v1/users/?page=1&per_page=10&role=Instructor&search=Juan
```

Response 200 example:

```json
{
  "success": true,
  "data": {
    "users": [ { "id":1, "fullname":"Juan P√©rez", "identification":12345678 } ],
    "pagination": { "page":1, "per_page":10, "total":25 }
  }
}
```

### POST /api/v1/users/

Body example:

```json
{
  "fullname": "Mar√≠a Garc√≠a",
  "identification": 87654321,
  "password": "password123",
  "role": "Instructor",
  "status": true
}
```

Response: `201` (created). Do not return passwords in responses.

### GET /api/v1/users/{id}

### PUT /api/v1/users/{id}

Body (partial allowed):

```json
{
  "fullname": "Nombre Actualizado",
  "password": "nueva_password",
  "status": false
}
```

### DELETE /api/v1/users/{id}

Response: `200` with confirmation or `204`.

---

## Animales

### GET /api/v1/animals/

Query params: `page`, `per_page`, `search`, `breeds_id`, `sex`, `status`, `sort_by`, `sort_order`

Example:

```http
GET /api/v1/animals/?status=Vivo&sex=Hembra&sort_by=weight&sort_order=desc
```

### POST /api/v1/animals/

Body example:

```json
{
  "sex": "Hembra",
  "birth_date": "2023-06-15",
  "weight": 380,
  "record": "BOV-002-2023",
  "status": "Vivo",
  "breeds_id": 1
}
```

### GET /api/v1/animals/{id}
### PUT /api/v1/animals/{id}
### DELETE /api/v1/animals/{id}

### GET /api/v1/animals/status

Response (200) example:

```json
{
  "success": true,
  "data": {
    "total_animals": 150,
    "by_status": { "Vivo": 120, "Vendido": 25, "Muerto": 5 }
  }
}
```

---

## M√≥dulos adicionales (resumen r√°pido)

- `/api/v1/medical/` : tratamientos, vacunaciones, medicaciones.
- `/api/v1/breeds-species/` : especies y razas.
- `/api/v1/relations/` : relaciones entre entidades (animal-disease, animal-field, treatment-medications).
- `/api/v1/analytics/` : dashboards, alertas y reportes.

---

## Errores comunes

Standard error example:

```json
{
  "success": false,
  "message": "Error de validaci√≥n",
  "errors": { "field_name": ["Este campo es requerido"] },
  "timestamp": "2025-09-02T10:30:00Z"
}
```

---

## Buenas pr√°cticas r√°pidas

- No exponer contrase√±as ni hashes.
- Usar paginaci√≥n y filtrar en endpoints que devuelven listas grandes.
- Almacenar tokens de forma segura (cookies seguras o storage con protecci√≥n).
- Documentar cambios en este archivo y mantener versi√≥n de API.

**√öltima actualizaci√≥n**: Septiembre 2025
  </script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', ()=>{
      const md = document.getElementById('md-source').textContent.trim();
      const html = marked.parse(md, {mangle: false, headerIds: true});
      document.getElementById('content').innerHTML = html;
      // Syntax highlight if available
      document.querySelectorAll('pre code').forEach((block)=>{
        block.classList.add('hljs');
      });
    });
  </script>
</body>
</html>
